package com.example.andreafranco.uberclone.utils;

import android.annotation.TargetApi;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.net.Uri;
import android.os.Build;
import android.text.TextUtils;
import android.util.Log;

import com.example.andreafranco.uberclone.R;
import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.PolylineOptions;

import org.json.JSONObject;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLDecoder;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import static com.example.andreafranco.uberclone.BuildConfig.DEBUG;

public class HttpUtils {

    private static final String TAG = HttpUtils.class.getSimpleName();
    private static final String LOG_TAG = HttpUtils.class.getSimpleName();
    private static final Uri.Builder sUriBuilder = buildUriRoute();

    private static Uri.Builder buildUriRoute() {
        Uri.Builder builder = new Uri.Builder();
        builder.scheme("https")
                .authority("maps.googleapis.com")
                .appendPath("maps")
                .appendPath("api")
                .appendPath("directions")
                .appendPath("json")
                .appendQueryParameter("sensor", "false");
        return builder;
    }

    /**
     * User the query parameter for creating url and getting the List of images
     * @param origin
     * @param destination
     * @return
     */
    public static PolylineOptions fetchImageListData(LatLng origin, LatLng destination, Context context) {
        // Origin of route
        String str_origin = origin.latitude + "," + origin.longitude;

        // Destination of route
        String str_dest = destination.latitude + "," + destination.longitude;

        // Api Key
        String api_key = context.getString(R.string.google_maps_key);

        sUriBuilder.appendQueryParameter("origin", str_origin);
        sUriBuilder.appendQueryParameter("destination", str_dest);
        sUriBuilder.appendQueryParameter("key", api_key);
        URL url = createUrl(sUriBuilder.build().toString());

        String jsonResponse = null;
        try {
            //Account has only 2 call a day, therefore we set a standard call for test
            if (DEBUG) {
                jsonResponse = "{   \"geocoded_waypoints\" : [      {         \"geocoder_status\" : \"OK\",         \"place_id\" : \"ChIJGako1Xc1ekcR1cjjr74piH8\",         \"types\" : [ \"street_address\" ]      },      {         \"geocoder_status\" : \"OK\",         \"place_id\" : \"ChIJE00BmlfafkcRNrRUYJMMyrg\",         \"types\" : [ \"street_address\" ]      }   ],   \"routes\" : [      {         \"bounds\" : {            \"northeast\" : {               \"lat\" : 46.1056932,               \"lng\" : 13.2315586            },            \"southwest\" : {               \"lat\" : 45.4040115,               \"lng\" : 11.8844614            }         },         \"copyrights\" : \"Map data Â©2019 Google\",         \"legs\" : [            {               \"distance\" : {                  \"text\" : \"152 km\",                  \"value\" : 151824               },               \"duration\" : {                  \"text\" : \"1 hour 54 mins\",                  \"value\" : 6825               },               \"end_address\" : \"Via Aristide Gabelli, 24, 35121 Padova PD, Italy\",               \"end_location\" : {                  \"lat\" : 45.4063244,                  \"lng\" : 11.8844614               },               \"start_address\" : \"Via Tricesimo, 208, 33100 Udine UD, Italy\",               \"start_location\" : {                  \"lat\" : 46.0945344,                  \"lng\" : 13.2310999               },               \"steps\" : [                  {                     \"distance\" : {                        \"text\" : \"0.1 km\",                        \"value\" : 119                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 16                     },                     \"end_location\" : {                        \"lat\" : 46.0950838,                        \"lng\" : 13.2310937                     },                     \"html_instructions\" : \"Head \\u003cb\\u003eeast\\u003c/b\\u003e toward \\u003cb\\u003eVia Tricesimo\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"yyixGkewoA@C@E@C?E?E?O?GCOEIACCCECEAEAG?E?_@DC?C@GBIHABCBABABADCF?J@F?HBJ\"                     },                     \"start_location\" : {                        \"lat\" : 46.0945344,                        \"lng\" : 13.2310999                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 211                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 23                     },                     \"end_location\" : {                        \"lat\" : 46.0944385,                        \"lng\" : 13.2286639                     },                     \"html_instructions\" : \"Exit the roundabout onto \\u003cb\\u003eVia Puintat\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"g}ixGiewoADHBBBBFDDHFHDHDHBH@D@F@H?HBFAZAHAJAH?LAJ?H?L@L@LDV?DDTBPFPBNDJDPBJFLFVBHFd@\"                     },                     \"start_location\" : {                        \"lat\" : 46.0950838,                        \"lng\" : 13.2310937                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.7 km\",                        \"value\" : 686                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 52                     },                     \"end_location\" : {                        \"lat\" : 46.0932328,                        \"lng\" : 13.2202358                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e2nd\\u003c/b\\u003e exit onto \\u003cb\\u003eVia Pascats\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"gyixGcvvoAA?C@A@CBA@A@ABABABAB?BAB?B?BAD?B@B?B?D@B?B@B@B@@@B@BB@@@@@B@@@B?@@B?@?B?PfD^bGb@pHh@hIHrBNjBRvAPjANx@PbA\"                     },                     \"start_location\" : {                        \"lat\" : 46.0944385,                        \"lng\" : 13.2286639                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.4 km\",                        \"value\" : 377                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 32                     },                     \"end_location\" : {                        \"lat\" : 46.0934357,                        \"lng\" : 13.2155894                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e2nd\\u003c/b\\u003e exit onto \\u003cb\\u003eVia Gran Selva\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"uqixGoauoAEBCBEBCDCDADCFAF?FAF?F?F@H?FBF@DBF@DDDBBBBDBGVATE\\\\GrAApE?FC~D?b@E`@A`@CpB\"                     },                     \"start_location\" : {                        \"lat\" : 46.0932328,                        \"lng\" : 13.2202358                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"1.7 km\",                        \"value\" : 1651                     },                     \"duration\" : {                        \"text\" : \"2 mins\",                        \"value\" : 96                     },                     \"end_location\" : {                        \"lat\" : 46.1043908,                        \"lng\" : 13.2012557                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e1st\\u003c/b\\u003e exit onto \\u003cb\\u003eVia Milano\\u003c/b\\u003e/\\u003cb\\u003eSP49\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"_sixGmdtoACHCHCJCJAJAJ?JAJ[p@Ub@CDOTaBxB_@\\\\_@b@ILwKbOqBvC{@lAeAxAu@bAaB|BOVSRgBfCiBbCkA`ByApBy@fA}@nAe@n@CBGHQVOR}B`DiA|Ay@jASXiCnDKLUZILQRSZGF\"                     },                     \"start_location\" : {                        \"lat\" : 46.0934357,                        \"lng\" : 13.2155894                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 206                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 13                     },                     \"end_location\" : {                        \"lat\" : 46.10579389999999,                        \"lng\" : 13.1995138                     },                     \"html_instructions\" : \"Continue onto \\u003cb\\u003eSP49\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"mwkxG{jqoAc@n@CDIDMLwAhB_ChD\"                     },                     \"start_location\" : {                        \"lat\" : 46.1043908,                        \"lng\" : 13.2012557                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 194                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 17                     },                     \"end_location\" : {                        \"lat\" : 46.1042231,                        \"lng\" : 13.1990218                     },                     \"html_instructions\" : \"Turn \\u003cb\\u003eleft\\u003c/b\\u003e onto the ramp to \\u003cb\\u003eSS13\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"e`lxG}_qoAGHDFT^JJ^Pp@@`ABj@BnADH@\"                     },                     \"start_location\" : {                        \"lat\" : 46.10579389999999,                        \"lng\" : 13.1995138                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"6.2 km\",                        \"value\" : 6229                     },                     \"duration\" : {                        \"text\" : \"4 mins\",                        \"value\" : 265                     },                     \"end_location\" : {                        \"lat\" : 46.0514003,                        \"lng\" : 13.2036361                     },                     \"html_instructions\" : \"Keep \\u003cb\\u003eleft\\u003c/b\\u003e and merge onto \\u003cb\\u003eSS13\\u003c/b\\u003e\",                     \"maneuver\" : \"keep-left\",                     \"polyline\" : {                        \"points\" : \"kvkxG{|poAd@Dd@@j@DJAL?LCJCHCJEDEFEJMFKFIDMDMBMFQDIBG@IBGBIFMHKBEDEFGNIJGHCJCLAN?^?~B|@dQtG|Bz@jAb@x@ZzBz@JDxAj@v@X`Bl@zBz@xDvAvFtBtEdBbBn@bBn@vDvAxChAtDtAfAb@n@Tl@T|EhBdBp@^NJBDBTF`FlBp@T`AVh@JZDf@HZBZBZBZ@pADbABZ@h@Af@AVARAXCZEZGXGZGf@Od@Or@[d@Sf@Yx@k@n@g@d@a@bB_BlDkDf@g@XW^_@TUb@a@`@a@`@a@j@k@`@_@b@_@VSb@[RMVMf@[b@Sb@UZMXKXKh@Qh@M`BWx@MRCt@IlCQDAvAKjAKpBKXC@?PA~Io@nF_@nGa@|BM|Iq@ZAh@EHAPApJq@PAD?LC@?fAK`BW`@Ih@KdBc@l@Qt@U^M^Mt@[`Bw@~A{@zByArH}ErA}@|B}AxGkEtCmB\"                     },                     \"start_location\" : {                        \"lat\" : 46.1042231,                        \"lng\" : 13.1990218                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.7 km\",                        \"value\" : 698                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 84                     },                     \"end_location\" : {                        \"lat\" : 46.0472373,                        \"lng\" : 13.1981324                     },                     \"html_instructions\" : \"Exit onto \\u003cb\\u003eVia Santa Caterina\\u003c/b\\u003e/\\u003cb\\u003eSS13\\u003c/b\\u003e toward \\u003cb\\u003eVenezia\\u003c/b\\u003e/\\u003cb\\u003ePordenone\\u003c/b\\u003e/\\u003cb\\u003ePasian di Prato\\u003c/b\\u003e\",                     \"maneuver\" : \"ramp-right\",                     \"polyline\" : {                        \"points\" : \"glaxGwyqoAb@GXEL@PDHFLNX^Z^RPPFP@NAJAJGTOHEFEDCHAHAJ?FBD@RNj@fBNRj@dBHTBFp@vB^dAr@xBz@nCdA|CdArC\"                     },                     \"start_location\" : {                        \"lat\" : 46.0514003,                        \"lng\" : 13.2036361                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"1.2 km\",                        \"value\" : 1207                     },                     \"duration\" : {                        \"text\" : \"2 mins\",                        \"value\" : 96                     },                     \"end_location\" : {                        \"lat\" : 46.0404789,                        \"lng\" : 13.1863807                     },                     \"html_instructions\" : \"Continue straight onto \\u003cb\\u003eVia Campoformido\\u003c/b\\u003e/\\u003cb\\u003eSS13\\u003c/b\\u003e\",                     \"maneuver\" : \"straight\",                     \"polyline\" : {                        \"points\" : \"gr`xGiwpoARf@f@v@PVNTfAdB~AdCpDbFj@z@r@bAj@v@dGpIjBnCdAjA~AlC^`ADPh@fBb@nBTfANx@Hx@HbAHhA@LVvAPt@Fb@@VAL\"                     },                     \"start_location\" : {                        \"lat\" : 46.0472373,                        \"lng\" : 13.1981324                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 208                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 18                     },                     \"end_location\" : {                        \"lat\" : 46.0392823,                        \"lng\" : 13.185938                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e1st\\u003c/b\\u003e exit and stay on \\u003cb\\u003eVia Campoformido\\u003c/b\\u003e/\\u003cb\\u003eSS13\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"_h_xG{mnoACRAP?T?RBPBRDPFNLTPPRJRDR?TGPKNQ@?TYZ]V[\"                     },                     \"start_location\" : {                        \"lat\" : 46.0404789,                        \"lng\" : 13.1863807                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"4.8 km\",                        \"value\" : 4838                     },                     \"duration\" : {                        \"text\" : \"5 mins\",                        \"value\" : 295                     },                     \"end_location\" : {                        \"lat\" : 46.01337040000001,                        \"lng\" : 13.1383312                     },                     \"html_instructions\" : \"Turn \\u003cb\\u003eright\\u003c/b\\u003e to stay on \\u003cb\\u003eVia Campoformido\\u003c/b\\u003e/\\u003cb\\u003eSS13\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eContinue to follow SS13\\u003c/div\\u003e\",                     \"maneuver\" : \"turn-right\",                     \"polyline\" : {                        \"points\" : \"o`_xGcknoAD@|@NfFhATDND@@NNTZb@p@`FlHtF`ItEnGpDdFnYta@hLhPHNpC~DnEjGb@l@p@`A|AzBFHb@j@j@x@tBvCHL@@LP`AvALRZb@LNV^T\\\\z@jAJNX`@~A|BdA|A`@n@DNBF@@Tr@Pt@@HR|ANnAFh@F`@Dd@J~@NxANvA@FB\\\\D`@Ff@Jr@BR@DRp@N`@HRn@zADJjA`GdB`JR~@~AjInB~Jt@zDb@tB@BjAnGlAhG|AdIP|@f@dC~@zEDNZbB`DlPFl@Lv@D^@P?Z\"                     },                     \"start_location\" : {                        \"lat\" : 46.0392823,                        \"lng\" : 13.185938                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.9 km\",                        \"value\" : 911                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 79                     },                     \"end_location\" : {                        \"lat\" : 46.0070592,                        \"lng\" : 13.1434615                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e3rd\\u003c/b\\u003e exit onto \\u003cb\\u003eVia Vittorio Veneto\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"q~ywGqaeoAABABAD?BAD?B?D?B?F?B@D@B?B@DBB@B@@BB@@@@@@B@@?B@@?@?F?BA@ABABA@ABC@C@A@C@C@A?C@C?C?C@AZYROTMHGLIrCqAz@g@@?`Ae@v@[lD}ABAnAm@XM@ALG`@SPIHIZULKFKZc@NWDIZw@Po@He@@OHm@JkAFq@BW@GBK@E@C@EBIBEBEDENOHCHCVE\\\\GFCl@MBA^K\"                     },                     \"start_location\" : {                        \"lat\" : 46.01337040000001,                        \"lng\" : 13.1383312                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"2.3 km\",                        \"value\" : 2340                     },                     \"duration\" : {                        \"text\" : \"3 mins\",                        \"value\" : 161                     },                     \"end_location\" : {                        \"lat\" : 45.9886918,                        \"lng\" : 13.1329239                     },                     \"html_instructions\" : \"Continue onto \\u003cb\\u003eVia Podgora\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"cwxwGsafoA\\\\CP?@?JABABAFCFEPQNKZ@t@L`@HTBL@J?d@ED?PCbAMZAVAL@B?H@JBVHHDDDFDFFRXFHHPDJHRVl@LXxBtFbAdCpAdD`C~FDJ\\\\v@f@z@v@~@v@j@PJZLj@N|@LfN|@|Hb@dEZp@F`@F`@J~@ZlA\\\\j@TRHRLLDz@n@xCdC`Ax@p@b@HBbAl@`Ad@d@VZLXJl@VVFTHn@Rz@RhBfAb@TFB\"                     },                     \"start_location\" : {                        \"lat\" : 46.0070592,                        \"lng\" : 13.1434615                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"72 m\",                        \"value\" : 72                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 9                     },                     \"end_location\" : {                        \"lat\" : 45.9883581,                        \"lng\" : 13.1332727                     },                     \"html_instructions\" : \"Continue straight\",                     \"maneuver\" : \"straight\",                     \"polyline\" : {                        \"points\" : \"iduwGw_doAFDFDFDFBD?FABABAFEDKBEBG?MAOGW\"                     },                     \"start_location\" : {                        \"lat\" : 45.9886918,                        \"lng\" : 13.1329239                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"7.5 km\",                        \"value\" : 7517                     },                     \"duration\" : {                        \"text\" : \"6 mins\",                        \"value\" : 343                     },                     \"end_location\" : {                        \"lat\" : 45.9367609,                        \"lng\" : 13.074504                     },                     \"html_instructions\" : \"Continue onto \\u003cb\\u003eSP95\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"gbuwG}adoAG]CQCOAQAM?M@W@c@DQBKBIBIBE@CBGFKFIDGDEDEDELIHCFCBAFCFAD?B?HAN@H@B@TFDBBBDBJHLLPTtCrDJN@?JLvHvJrMhPrItK`D|DbKhMlp@xy@rClDp@x@pBdCl@v@zD|EHLZ^BDRRBBTVHH~BxCbArAn@z@jNdQt@`AhElFFHRRJLPRV^LJtCrDvAhBvVb[hKpMhDjEHHTXPRPTBBJJ\\\\f@~FnH~N|QDL@BbAtAdAvAnAxALLdAxAJLd@l@jCxCJFzD|E~@hANR@@PTtE~FJRBHdBvBDFzAjBFHvAdBjAvABBLJDBDF~AjB@@Zb@b@h@f@p@pUvYfBvBR|@\"                     },                     \"start_location\" : {                        \"lat\" : 45.9883581,                        \"lng\" : 13.1332727                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"61 m\",                        \"value\" : 61                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 6                     },                     \"end_location\" : {                        \"lat\" : 45.9363428,                        \"lng\" : 13.0741404                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e2nd\\u003c/b\\u003e exit\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"w_kwGsrxnA?@?B?B?@?B?@@@?@?B@@@B?@@B@@@@@@@@@@@?@@@?B@@?@?@?@?@?HHNDRB\"                     },                     \"start_location\" : {                        \"lat\" : 45.9367609,                        \"lng\" : 13.074504                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"5.9 km\",                        \"value\" : 5899                     },                     \"duration\" : {                        \"text\" : \"5 mins\",                        \"value\" : 270                     },                     \"end_location\" : {                        \"lat\" : 45.8954377,                        \"lng\" : 13.0256155                     },                     \"html_instructions\" : \"Continue onto \\u003cb\\u003eSP95\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"c}jwGkpxnABBzBnC@@jBdC`GdHb@l@|@fA`@d@rA|AdAnAxAjB~@nArBfCnBfCvE|FvDxErGjIfWr[rM|Otd@fk@dE~FJNJJJJPXf@n@HHDFfEjFzz@zeAX\\\\JLpe@tl@zBpCJLFLd@x@BDBD@F@F\"                     },                     \"start_location\" : {                        \"lat\" : 45.9363428,                        \"lng\" : 13.0741404                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"1.8 km\",                        \"value\" : 1769                     },                     \"duration\" : {                        \"text\" : \"2 mins\",                        \"value\" : 99                     },                     \"end_location\" : {                        \"lat\" : 45.8831625,                        \"lng\" : 13.0113018                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e2nd\\u003c/b\\u003e exit and stay on \\u003cb\\u003eSP95\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"o}bwGcaonA?D?D?B?D@D?B@D@B@B@B@BBB@BB@@@B@@@B?D?@?@?@?@?BA@?@A@ADBLJRNJJHJLLHDrWd\\\\xl@vs@n@tAHN\"                     },                     \"start_location\" : {                        \"lat\" : 45.8954377,                        \"lng\" : 13.0256155                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"5.1 km\",                        \"value\" : 5108                     },                     \"duration\" : {                        \"text\" : \"4 mins\",                        \"value\" : 263                     },                     \"end_location\" : {                        \"lat\" : 45.8556395,                        \"lng\" : 12.9603828                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e3rd\\u003c/b\\u003e exit and stay on \\u003cb\\u003eSP95\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"wp`wGsglnAABCDABADADAD?DAD?F?D?F?D@D?F@D@B@D@B@B@B@@@B@BBBB@BBB@B@B@D@B?B?B?B?@?BAB?@ABA@AZPFFDHDLP`@FJVXrGdGvGtIvKbNbTdXDDpAvAp@dATXDFb@h@PPLLJJj@v@DFFFh@r@`GnH^f@p@|@jA~AbAxAl@|@pArBf@|@jAtB|AtChAtB|@lBJRLVt@bBl@xAJVBPXp@fApCJ\\\\Zv@l@hB@D?BBDp@fBRj@BHVv@r@|BRj@L\\\\@DhAdEbA|D@BDNLZl@~Bl@`C`AxDbBtGpDlNdBxG`BhG|BxIDPBL@@DLf@rBbDhMBJ@@@BBJFVdA~DbBrGx@|C`@~A|B|Iv@|CNj@HZ`@zAHZr@rCHVL`@l@`CLb@d@lBBJNz@\"                     },                     \"start_location\" : {                        \"lat\" : 45.8831625,                        \"lng\" : 13.0113018                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"7.1 km\",                        \"value\" : 7107                     },                     \"duration\" : {                        \"text\" : \"5 mins\",                        \"value\" : 326                     },                     \"end_location\" : {                        \"lat\" : 45.82625059999999,                        \"lng\" : 12.8792645                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e3rd\\u003c/b\\u003e exit onto \\u003cb\\u003eSP40\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"wd{vGkibnAA@A@CBA@AB?@ABAB?BAF?B?D?B?B?B?B@B@B?B@B@B@@BB@@B@@@B@B@B?B@@A@?@?@A@?@A@?BAT~@BDFXb@|AtElQdLtc@zCfL~@dDRz@Jf@x@~CFRnA~ElEvPl@zBbLfc@dHhX`HbXdAxDXjADNbClJvBjI|BzIzBtIxChLjAdEvAxF`AxDjBfHh@pBPn@`BrGbD|L~CzLh@rBzFvTzCjLp@hCDP~A~Fb@~ADPLf@Lf@Nh@x@fDv@xClAtEfDpMbDbMrCxKbDhM~BxIH^HT?BFRhAhEfBvGZhANlA\"                     },                     \"start_location\" : {                        \"lat\" : 45.8556395,                        \"lng\" : 12.9603828                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"3.3 km\",                        \"value\" : 3285                     },                     \"duration\" : {                        \"text\" : \"3 mins\",                        \"value\" : 186                     },                     \"end_location\" : {                        \"lat\" : 45.8079194,                        \"lng\" : 12.8543493                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e2nd\\u003c/b\\u003e exit onto \\u003cb\\u003eVia Udine\\u003c/b\\u003e/\\u003cb\\u003eSP93\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"amuvGknrmAABABAB?BAB?B?D?@?@?D?B?B@@?@@@?B@@@B@@@B@@BB@@@@@?B@@@@?@?d@bATx@v@|C|@dDJ\\\\b@bB^rAZlARz@ZfAn@vBHTb@xAzBdG~AvD~BtEh@bA`@t@rClEpBpCx@fADFLNNRnEzEDJNTr@p@LNTR`@V`@RRJPJj@Px@PbCVv@D~@FpBPBAtEf@jGv@hDh@hAX`AXfA`@|B|@^NLF`@XrChBPLFDbFrDhChB\\\\VTRTTTXf@x@^`AVjA@JBPBXD\\\\@j@?|@?f@Gv@Ed@Mp@U|@Yx@I\\\\I\\\\Mj@yA`GOn@GHMXCFEDEBC@GFCDEFADEL\"                     },                     \"start_location\" : {                        \"lat\" : 45.82625059999999,                        \"lng\" : 12.8792645                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"2.8 km\",                        \"value\" : 2782                     },                     \"duration\" : {                        \"text\" : \"3 mins\",                        \"value\" : 168                     },                     \"end_location\" : {                        \"lat\" : 45.7865298,                        \"lng\" : 12.8391975                     },                     \"html_instructions\" : \"Turn \\u003cb\\u003eleft\\u003c/b\\u003e onto \\u003cb\\u003eStrada Statale del Tagliamento\\u003c/b\\u003e/\\u003cb\\u003eSP463\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eContinue to follow SP463\\u003c/div\\u003e\",                     \"maneuver\" : \"turn-left\",                     \"polyline\" : {                        \"points\" : \"ozqvGurmmAGLJPT`@Vf@HL`@j@j@j@jA`ANJFAfAt@`BhA|AdAbCfBJDLHNHl@\\\\XJHDjA\\\\v@Lj@HH@b@@~A@vDUjCEtAHrAPnBb@l@P`@Pt@\\\\ZLXPRLLFb@ZXRRN|ArAlBxBhAhBpA~Bb@z@`@t@tB|D`@r@h@bAtAdC`D`Gl@|@PPPP\\\\Td@RZHXDP@R?^AREXINEt@QNEn@?j@DVDd@JVJZNt@d@lCzBr@r@PRNLTTRNDFHDz@x@dA~@FFf@b@\\\\XJFLJXTt@h@\\\\Rh@^NHB@|@^\"                     },                     \"start_location\" : {                        \"lat\" : 45.8079194,                        \"lng\" : 12.8543493                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.7 km\",                        \"value\" : 724                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 67                     },                     \"end_location\" : {                        \"lat\" : 45.7860786,                        \"lng\" : 12.8301188                     },                     \"html_instructions\" : \"Turn \\u003cb\\u003eright\\u003c/b\\u003e onto \\u003cb\\u003eVia S. Martino\\u003c/b\\u003e\",                     \"maneuver\" : \"turn-right\",                     \"polyline\" : {                        \"points\" : \"ytmvG_tjmASbAg@jCCLAP?T?`@LfC@LFhAH`BDfANzBDr@FdAJvBBr@?B@T@HX~AFNBL\\\\rABNBR@N?\\\\EjD?fA?\\\\APAT?P?J?LAT\"                     },                     \"start_location\" : {                        \"lat\" : 45.7865298,                        \"lng\" : 12.8391975                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.1 km\",                        \"value\" : 141                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 19                     },                     \"end_location\" : {                        \"lat\" : 45.7869626,                        \"lng\" : 12.8289891                     },                     \"html_instructions\" : \"Slight \\u003cb\\u003eright\\u003c/b\\u003e onto \\u003cb\\u003eViale Pordenone\\u003c/b\\u003e\",                     \"maneuver\" : \"turn-slight-right\",                     \"polyline\" : {                        \"points\" : \"_rmvGg{hmA]x@m@~AM^KPEFGBEBG@E@G?I?U@\"                     },                     \"start_location\" : {                        \"lat\" : 45.7860786,                        \"lng\" : 12.8301188                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.3 km\",                        \"value\" : 295                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 38                     },                     \"end_location\" : {                        \"lat\" : 45.7890003,                        \"lng\" : 12.8273292                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e2nd\\u003c/b\\u003e exit onto \\u003cb\\u003eViale Pordenone\\u003c/b\\u003e/\\u003cb\\u003eSR251\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"owmvGethmAEGCEEEEEEEECGCECKAIAK?I?KBIDIDMJEFGLGLENCNCNAP?PS\\\\KPQRMLKPcA~@a@^OHe@X\"                     },                     \"start_location\" : {                        \"lat\" : 45.7869626,                        \"lng\" : 12.8289891                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"1.4 km\",                        \"value\" : 1355                     },                     \"duration\" : {                        \"text\" : \"2 mins\",                        \"value\" : 105                     },                     \"end_location\" : {                        \"lat\" : 45.7984741,                        \"lng\" : 12.8176132                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e2nd\\u003c/b\\u003e exit and stay on \\u003cb\\u003eViale Pordenone\\u003c/b\\u003e/\\u003cb\\u003eSR251\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eContinue to follow SR251\\u003c/div\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"gdnvGyihmAAIACAEACACACCCACCACAAACAC?C?C?C@A?CBC@A@CBCDCBABAB?DAB?D?B?D?B?D@B?D@BkAjASR{AxAgBbBaB`B}AfBSVKLCB[^sE|F[`@yArBORORiBjCeAtAa@h@GHm@x@q@x@cCrCMNGHMNeBrBMNm@l@GHSN{@bAWZWTMNONKBKBM?IAKEIEGGGGMK\"                     },                     \"start_location\" : {                        \"lat\" : 45.7890003,                        \"lng\" : 12.8273292                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"92 m\",                        \"value\" : 92                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 8                     },                     \"end_location\" : {                        \"lat\" : 45.798991,                        \"lng\" : 12.8185083                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e1st\\u003c/b\\u003e exit\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"m_pvGamfmAEIEICGGGEEEEGEGCIYWu@Qi@\"                     },                     \"start_location\" : {                        \"lat\" : 45.7984741,                        \"lng\" : 12.8176132                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.4 km\",                        \"value\" : 438                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 32                     },                     \"end_location\" : {                        \"lat\" : 45.7990967,                        \"lng\" : 12.823845                     },                     \"html_instructions\" : \"Take the ramp to \\u003cb\\u003eTrieste Udine\\u003c/b\\u003e/\\u003cb\\u003eVenezia\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003ePartial toll road\\u003c/div\\u003e\",                     \"polyline\" : {                        \"points\" : \"ubpvGurfmAGYEUU_AOu@OiAIy@Ko@QgDE_BAu@AiABcAJaAF]FSFYFQL[N]FKH]\"                     },                     \"start_location\" : {                        \"lat\" : 45.798991,                        \"lng\" : 12.8185083                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.4 km\",                        \"value\" : 361                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 38                     },                     \"end_location\" : {                        \"lat\" : 45.7965117,                        \"lng\" : 12.8266092                     },                     \"html_instructions\" : \"Merge onto \\u003cb\\u003eA28 Portogruaro - Conegliano\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eToll road\\u003c/div\\u003e\",                     \"maneuver\" : \"merge\",                     \"polyline\" : {                        \"points\" : \"kcpvG_tgmA|@eA|DqFj@_AT[VUVUl@e@RMTO^S^Q\"                     },                     \"start_location\" : {                        \"lat\" : 45.7990967,                        \"lng\" : 12.823845                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.6 km\",                        \"value\" : 589                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 32                     },                     \"end_location\" : {                        \"lat\" : 45.7919776,                        \"lng\" : 12.824572                     },                     \"html_instructions\" : \"Take the \\u003cb\\u003eE55\\u003c/b\\u003e/\\u003cb\\u003eA4\\u003c/b\\u003e/\\u003cb\\u003eE70\\u003c/b\\u003e exit toward \\u003cb\\u003eVenezia\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eToll road\\u003c/div\\u003e\",                     \"maneuver\" : \"ramp-right\",                     \"polyline\" : {                        \"points\" : \"esovGiehmAh@KREVId@I\\\\GRCRA\\\\C^?hC?lC@\\\\F^Dh@P^R^XPLHH\\\\b@PVP\\\\JVHPHTFTNj@ZxALXHV\"                     },                     \"start_location\" : {                        \"lat\" : 45.7965117,                        \"lng\" : 12.8266092                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"44.4 km\",                        \"value\" : 44357                     },                     \"duration\" : {                        \"text\" : \"24 mins\",                        \"value\" : 1446                     },                     \"end_location\" : {                        \"lat\" : 45.5765717,                        \"lng\" : 12.34941                     },                     \"html_instructions\" : \"Merge onto \\u003cb\\u003eA4\\u003c/b\\u003e/\\u003cb\\u003eE70\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eToll road\\u003c/div\\u003e\",                     \"maneuver\" : \"merge\",                     \"polyline\" : {                        \"points\" : \"{vnvGqxgmAf@lCLn@^lBr@fEd@jC|@xF^jCF`@Fb@|AvLh@|EVhCXpCZnDLxAV~CVpD^tFd@pHDb@Bb@RzCRfDRxCBV@TJxAX`E^~ERvBNbBVpCB^@FBVT~BtAfMh@fEx@lG|@bG^dC~@~FfAhGz@xE`AxEt@pDfAfFzAnG|BhJNf@Nf@t@pCnAnE`C~HNb@Lb@vAlE`@nApBxFd@rAdArCdBnE|@zBh@rA~@tBz@tBxB|EvCtGtF~LdG|Mt@`Bt@bBjBdElGlNrHrPlGlNrClGdB~Dx@fBvCtG`@x@j@lAjCzFdBlDzAvClBpD|@bBzApCr@lAlNxV`MnTxD|Gr@nAr@tAp@lANXvBjEvApCpCjGjBhEfAlC`A`Cp@hBFPFPv@rBdA|ChBnFJX@DL^~AfFbCvIzBrIpAlFbMlk@?@xLjj@tIl`@rHf]|DxQbD`OJb@lA|F`@hBj@fCnCzL^fBDP?BJ`@p@|CFTBPZtAvC|MtBlJlAtFLd@Jd@p@zCH`@Hb@BFtApGhBfIJd@BNDRhEvRJb@TdA|BnKt@fDr@`DfA`FfA~EhBhIj@jCtAnGxAvGhAfFbAtE~@bEnA|FlAlFXhApAbFxApFh@nBd@~AXfAxA|EdAhDbAbDbAtCxAdEtBzFTh@DHr@dAHNFNj@vAd@hA|DhJ`AvBlAjCdChFbArBbAvBnAdCzBtEnAjCjBvD|A~Ct@~ApC|FzAzClBzDrArCt@zAt@|ApAhC|AbDv@|AjDjHvDzHP`@pCzFNXZp@rAxCj@lAt@fB|AtDfChGRf@|DvKj@`Bn@lBv@bCz@fC@@hAvDv@fChAzDl@vBXhAr@jCr@lCz@jDlCjKJ\\\\vBbK`@dBfCtJDNxBnIBJhBbHDT@@FTn@dCrAhFbA|Dj@zBzBlIj@pBXbAv@lClAdEnA|Dv@`CjAnDf@xA|AlElBfF~@bCPf@tBrFpAlDbCrGd@pA`AjCnAbDxCfIHPtBzFxAvDVn@dCvGtArDx@xBfD|IHTxAxDnDtJf@rAlDnJh@tAlGpPPd@`BlEn@`Br@lB`EtKbExKbAlCd@pAfAvCHPdAxCn@`BtBlFhDnJnAbD`AhClAbDbAhCbArClAhD`BrE|AdEjB|EbApCn@dBbBpE^~@jB`F@BdBtEt@lBpAhDb@nA`@fA^~@p@pB`BjE~AhErAzDdAvChAnDn@jBlArDlAzDh@fBt@zBZdAZ`AX|@R|@^fAx@pCZdAz@rCv@nCTv@Tt@tB`Hj@lBd@zAd@zAj@nB~A~E`BhFlBxFZx@\\\\`A`AnCHRlAjDrArDv@zBhA|C|AnEj@zA`@hA|@nCVr@`AxCL\\\\lB~FBJh@bB`CrHbAzCFT`AvCdAhDtAlErAbEN`@~CrJxClJr@vBf@~AnD|KpCvItC~IxBzGx@fCbAzCRp@fAxCx@bCP`@h@vAhAvCt@fBJV|@tBlAtCv@bB`CjFdA|BlAhC|EpKfBxDbClFP^bBtDn@vAR`@fA~BlAhCb@bAv@bBzAdD^v@bClFzAbDf@fAbE~IVj@xElKt@|AbBrDjDrHr@~AFLFL|@lBf@fArAvCTb@xAdDl@tAVj@rArCx@lBRd@\\\\v@|@tBn@~AZx@FN^|@d@lAN`@~AjE`BtEN`@dB`FtB|FjGhQbC`HxA~D`@tAfA|CdAzCpApDDJFLHXdCzG\\\\~@lCrH`CzGbC~GpDfKxBfGl@jBh@tAbAvClAdDtBdGXv@zK|Zx@rBxAvDnAxCbA|BrAzCz@lBVh@Zr@P`@P^Rb@l@rAzCzGhCtF`E`JxBxEfB~Dp@zAv@bB\\\\t@Xl@Vl@~@pB`BtDBDlAlCtBtEfAbCnBjE~@pBXn@Zn@hAfChB`E|AfD|CzGdEfJzCzGlAnC~@rBzAdDlAlCvAtCvAxCjBrDpBvD`ChEhCpE|BvD`CzDxA`C@@FJzAfCpGhKrBjDtA|BnArBvF`JtJ~OhAjB~GbLXf@BD@@LTxTt^RZ?@NV`BhCV`@JNFHxEvHfBxClBbDz@zArA`CzArCzBlEfBnDTf@d@bA`C~EzCfGDH\"                     },                     \"start_location\" : {                        \"lat\" : 45.7919776,                        \"lng\" : 12.824572                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"43.4 km\",                        \"value\" : 43389                     },                     \"duration\" : {                        \"text\" : \"24 mins\",                        \"value\" : 1412                     },                     \"end_location\" : {                        \"lat\" : 45.4195517,                        \"lng\" : 11.9445611                     },                     \"html_instructions\" : \"Keep \\u003cb\\u003eleft\\u003c/b\\u003e at the fork to stay on \\u003cb\\u003eA4\\u003c/b\\u003e/\\u003cb\\u003eE70\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eToll road\\u003c/div\\u003e\",                     \"maneuver\" : \"fork-left\",                     \"polyline\" : {                        \"points\" : \"qtduGy~jjAdBtDz@pB`@dAl@|At@xBh@fBn@|Bj@bC`@lB^vBJj@`@lCTjBRfBFx@@NDf@@P@D@NPxCF|AD`BDfBBrA@lCAfBEbCGzBGzAMxBMvBU|BSfBShBm@jE]bC_BtK[nB}@lF_@hCG^ADE\\\\w@hF{@`G}@bGcGfa@mExY}ApK]pBe@vCe@fC[bBS|@?BA@SbAMh@{@nDSv@Oj@Wx@k@lB[fAYv@m@fBGL_@`AQd@Ul@Ul@_BxDu@dBw@fB{@jBkAhCsAzCcAtBwBxEmBhEoAzCYp@i@nAk@tAeCbHc@tAu@hCo@`Cq@pCy@xDc@vBw@lE{@~FIh@]tCaAbIe@|DgEj\\\\Gj@Gh@qAfKIt@_AhHaAjIc@xDOnAWjCWrCSlCOhCGnAGfAARCl@KnE?DC~BCvC?lB@nB?rABr@D|CD~AFdBFdAJdBD`AN~BRvBPjBl@bFd@hD`@dCj@~CpAfGfBvHhAlEbFbSdAtEz@xDNz@H`@@DFZf@tCf@hDJr@j@lEPjB\\\\`E^bGL`DHhCBtABhABnE?vAAbCQrHe@lLk@vKW|DcA|Ng@jHi@rHiBpWkAfP]vGUfFElBAn@GrD?P?dEB~CBfCDpBFlBJpCHnAPvCHtAVnCXnCXnCj@bEZlBTrAf@fCf@dC^bBJ^?@H\\\\^|A~@lD\\\\rA|HtYpAxElAtEdAvDf@lB~A~FdDzLr@jCJb@ZjAFTBD`BhGxHjYvDlNBJlAlE`BdGpFjS~AbGhAdELd@\\\\nAt@pCPl@fBjGnA~DnAxDtBxF`B`EvAdDz@hB^r@vBfE~@dBnAvBt@lAnAnBz@nAv@fAxCzDRXlDhDDDj@p@j@j@\\\\V@B|ApAv@j@r@h@|AdAv@d@d@XfAl@~At@nChA|Aj@rA`@lAZx@RvCh@NBXDNB~ARbBL|EZ`@B^@rJXx@FlCPfBN`AJjATvATv@R|@VlA\\\\|DdBhC`AbL`GfFfCjEzBjPrIfClAtDhBxBx@nAd@dD`AxA\\\\vCl@rDf@`AHbAHf@DlADzADhBDZ?xBCV?vKi@bAIhBIfBGdA?h@?F?lA@jADbBLv@HdC^|Bd@bFtApA^XFFBND`Dv@jATbBXx@Jp@FvAJxADz@BZ?H@lBCD?\\\\AH?BAN?bBKnBQpC[LA\\\\ERC~@KdBQ|CSzBIzBAD?^?^?v@@hAFbBH`AH|Gp@nALXDh@F`DZlCPtAD`CDhDCtEKbFMbFAtA?r@B|AFbCN|BVjH~@vAT~D`@z@BnADpA@dBC~AE~AGpCOrBKnCK~BE`@?b@?jABjA@hAD`ADt@BzAL~BZrDl@nCl@`AVdBf@~Ah@rAf@nCjA`Ab@xBjArE~BrH|DxC|Aj@VxAt@zDrB~Az@hDnBrBrAtAbAf@^rAhAp@n@n@p@r@v@VZn@t@dAtARX@@?@TZf@t@lApBt@vAp@tAl@tA~@~BZx@Xx@Vt@Vz@`@pARt@ZpAr@bDZzAZfBVxA`@fCPnAp@rEn@lEp@tET`Bb@|CrBpNz@xF`@fCJj@Jn@n@jD^dBd@nBf@lB\\\\hA`@pAh@zAv@rBXr@d@bAj@jAh@fAd@x@^p@hCxDp@z@~BpChCbCxBhB~@r@pBzAzAdAp@b@hAv@vA~@nExCjD~B|AdAvA|@`@Zh@\\\\vBvAdEnCrD~BpDbCdDxBfDzB^VjAv@jAx@xA`Ax@l@`@Xf@\\\\xBbBfA`AjBbBHJdAhA^`@~@fA`AjAJNTV^h@V^~@tAl@~@Xf@Xd@FHFNXd@Zl@R^Vh@Zr@Vh@Th@P^HVb@bAJV\\\\z@Rn@f@tAb@tAZ`APl@Nl@d@bBZtAXxAZtADZRhATnAb@bCN|@D\\\\DVFb@Jp@Jt@RxAVnBRbBDTHl@NpAPrA@PHn@L~@J~@RzAHx@Jv@Hj@BRf@bENhAD\\\\Hp@Hl@Fl@Hn@Hp@Jt@Fh@Hp@L~@Jx@BRJr@Fn@Jp@Jz@LfABPHn@Hr@Lz@Jz@LhATfBDXLdAR|AR~ATnBRdB^tCNlALfANlANfAJ|@Jt@VtBTlBD\\\\L~@Hn@Jv@Jt@LnALx@B\\\\Jt@LfANlAPtAPvAFf@Fb@Ff@Fh@Hl@Hl@NpARzARdBX`Cf@`EVtBX|Bh@fEpBrPj@nExAnLbAjInIhr@hBzNdJvu@BTBTdAjIH^nBbPfLl_A~Kz}@LdAnIvq@BRBP~Jfy@fA`JBRBPPvAh@lEVrBr@vFh@pEZfC^~CVjB^xCZdCXbCrDxZX`C\\\\xC`@dDVdBFj@Jn@b@dDJx@DZFd@@DtBjPj@jEBRBN?BFZ?BNhAn@hFXxBV|B~AxMtBpPTfBBN?B@BJ|@VtBVtBn@hF\"                     },                     \"start_location\" : {                        \"lat\" : 45.5765717,                        \"lng\" : 12.34941                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"1.1 km\",                        \"value\" : 1106                     },                     \"duration\" : {                        \"text\" : \"2 mins\",                        \"value\" : 98                     },                     \"end_location\" : {                        \"lat\" : 45.4173025,                        \"lng\" : 11.9330073                     },                     \"html_instructions\" : \"Take exit \\u003cb\\u003ePadova Est\\u003c/b\\u003e toward \\u003cb\\u003ePadova Est\\u003c/b\\u003e/\\u003cb\\u003ePadova Centro\\u003c/b\\u003e\",                     \"maneuver\" : \"ramp-right\",                     \"polyline\" : {                        \"points\" : \"e_ftGo|{gAJdC@fBAb@A\\\\Cj@ATCPCTEXEVEREPGVIXOd@Qh@Od@Mb@i@hBWp@Mf@CPAT?R?TBXD\\\\DNDLFPLVLRPRRNLFTJRFDBf@NJDLDd@NXH~@\\\\NFHDPLFDLLLPJLFLHNFNBDBJDNLr@@FRnAJbAJx@Bf@B`@?hADp@@l@Fp@Fl@Jx@RtAVfABNH^\"                     },                     \"start_location\" : {                        \"lat\" : 45.4195517,                        \"lng\" : 11.9445611                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"19 m\",                        \"value\" : 19                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 3                     },                     \"end_location\" : {                        \"lat\" : 45.4172847,                        \"lng\" : 11.9327696                     },                     \"html_instructions\" : \"Keep \\u003cb\\u003eright\\u003c/b\\u003e at the fork to continue toward \\u003cb\\u003eVia Sergio Fraccalanza\\u003c/b\\u003e\",                     \"maneuver\" : \"fork-right\",                     \"polyline\" : {                        \"points\" : \"cqetGitygABn@\"                     },                     \"start_location\" : {                        \"lat\" : 45.4173025,                        \"lng\" : 11.9330073                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.4 km\",                        \"value\" : 423                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 41                     },                     \"end_location\" : {                        \"lat\" : 45.4195705,                        \"lng\" : 11.9322249                     },                     \"html_instructions\" : \"Keep \\u003cb\\u003eright\\u003c/b\\u003e, follow signs for \\u003cb\\u003ePonte di Brenta\\u003c/b\\u003e\",                     \"maneuver\" : \"keep-right\",                     \"polyline\" : {                        \"points\" : \"_qetGyrygAELADAF?H?\\\\CTCJCJKVUXo@z@i@n@iAxA]f@OPOLIFKBK@K?E?EAIECCECEECEGKEKAGEOIk@_@wBWaB\"                     },                     \"start_location\" : {                        \"lat\" : 45.4172847,                        \"lng\" : 11.9327696                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 159                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 12                     },                     \"end_location\" : {                        \"lat\" : 45.4199203,                        \"lng\" : 11.9341936                     },                     \"html_instructions\" : \"Keep \\u003cb\\u003eright\\u003c/b\\u003e at the fork, follow signs for \\u003cb\\u003eCentro\\u003c/b\\u003e\",                     \"maneuver\" : \"fork-right\",                     \"polyline\" : {                        \"points\" : \"i_ftGkoygAUqBCYk@}F\"                     },                     \"start_location\" : {                        \"lat\" : 45.4195705,                        \"lng\" : 11.9322249                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.1 km\",                        \"value\" : 139                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 16                     },                     \"end_location\" : {                        \"lat\" : 45.42058859999999,                        \"lng\" : 11.9344196                     },                     \"html_instructions\" : \"Continue onto \\u003cb\\u003eVia Sergio Fraccalanza\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"oaftGu{ygAI}@C_@EWCMEEECECAACAEAIAE?A?G@EBEFEDCDGLCHCJIP?@CHAH?D\"                     },                     \"start_location\" : {                        \"lat\" : 45.4199203,                        \"lng\" : 11.9341936                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 173                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 15                     },                     \"end_location\" : {                        \"lat\" : 45.4198305,                        \"lng\" : 11.9325109                     },                     \"html_instructions\" : \"Slight \\u003cb\\u003eleft\\u003c/b\\u003e onto the ramp to \\u003cb\\u003eCentro\\u003c/b\\u003e/\\u003cb\\u003eChioggia\\u003c/b\\u003e/\\u003cb\\u003eSS304\\u003c/b\\u003e/\\u003cb\\u003eCastelfranco V.\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"ueftGc}ygA?@?F@J@FBLDPj@fBXbABDPh@Pp@BHBJDHLP\"                     },                     \"start_location\" : {                        \"lat\" : 45.42058859999999,                        \"lng\" : 11.9344196                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.9 km\",                        \"value\" : 868                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 64                     },                     \"end_location\" : {                        \"lat\" : 45.4166509,                        \"lng\" : 11.9224319                     },                     \"html_instructions\" : \"Merge onto \\u003cb\\u003eVia S. Marco\\u003c/b\\u003e\",                     \"maneuver\" : \"merge\",                     \"polyline\" : {                        \"points\" : \"}`ftGeqygA\\\\xBj@~CRnAd@fCF^r@zDJr@R|@`@vAZfAf@jB\\\\lAf@nBb@|AFRVz@bCxIRv@Rr@?H?B@R@J?F?H?HCV\"                     },                     \"start_location\" : {                        \"lat\" : 45.4198305,                        \"lng\" : 11.9325109                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 216                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 20                     },                     \"end_location\" : {                        \"lat\" : 45.4156369,                        \"lng\" : 11.920241                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e2nd\\u003c/b\\u003e exit onto \\u003cb\\u003eVia S. Marco\\u003c/b\\u003e/\\u003cb\\u003eVia Venezia\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"ametGerwgACNAB?F@L?B@B@@@B@BB@@B@@BBDDD?F@LHDBDBDFDJJVHNXhAr@dCJ\\\\Nh@\"                     },                     \"start_location\" : {                        \"lat\" : 45.4166509,                        \"lng\" : 11.9224319                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.9 km\",                        \"value\" : 931                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 66                     },                     \"end_location\" : {                        \"lat\" : 45.41166459999999,                        \"lng\" : 11.9097459                     },                     \"html_instructions\" : \"Continue straight onto \\u003cb\\u003eVia Venezia\\u003c/b\\u003e\",                     \"maneuver\" : \"straight\",                     \"polyline\" : {                        \"points\" : \"wfetGodwgA\\\\dA\\\\nAvFdSHT@FBHFRRx@l@tB@FV|@HVFVFVb@zAtAzEt@lC`@vAf@fBDb@FTpAzE\"                     },                     \"start_location\" : {                        \"lat\" : 45.4156369,                        \"lng\" : 11.920241                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.7 km\",                        \"value\" : 664                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 63                     },                     \"end_location\" : {                        \"lat\" : 45.4087508,                        \"lng\" : 11.9023439                     },                     \"html_instructions\" : \"Keep \\u003cb\\u003eleft\\u003c/b\\u003e to stay on \\u003cb\\u003eVia Venezia\\u003c/b\\u003e\",                     \"maneuver\" : \"keep-left\",                     \"polyline\" : {                        \"points\" : \"{mdtG}bugAZrAJ\\\\l@~B`@xAf@dBRb@jElOp@lB@@NTzArF`@zABN\"                     },                     \"start_location\" : {                        \"lat\" : 45.41166459999999,                        \"lng\" : 11.9097459                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.3 km\",                        \"value\" : 287                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 43                     },                     \"end_location\" : {                        \"lat\" : 45.407961,                        \"lng\" : 11.9003986                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e3rd\\u003c/b\\u003e exit onto \\u003cb\\u003eVia Fistomba\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"u{ctGstsgAIBGDEFEDGFGDOFIDCHEJAFAD?HAH@JDR@HBFBFB@D@B?F?FADEHEBCj@g@NJFDFDBFNf@HP^`ANZRlABL\"                     },                     \"start_location\" : {                        \"lat\" : 45.4087508,                        \"lng\" : 11.9023439                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.1 km\",                        \"value\" : 134                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 15                     },                     \"end_location\" : {                        \"lat\" : 45.4076384,                        \"lng\" : 11.8987415                     },                     \"html_instructions\" : \"Continue onto \\u003cb\\u003ePonte. Ognissanti\\u003c/b\\u003e\",                     \"polyline\" : {                        \"points\" : \"wvctGohsgAPvAHp@Fn@@FHt@NrA\"                     },                     \"start_location\" : {                        \"lat\" : 45.407961,                        \"lng\" : 11.9003986                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 181                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 26                     },                     \"end_location\" : {                        \"lat\" : 45.4072286,                        \"lng\" : 11.8966732                     },                     \"html_instructions\" : \"Continue onto \\u003cb\\u003eVia Ognissanti\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eGo through 1 roundabout\\u003c/div\\u003e\",                     \"polyline\" : {                        \"points\" : \"wtctGc~rgAVjCA?A??@A?A@A@?@A??@?@A@?@?@A@?@?@?@?B@@?@?@@@?@@@?@@??@@??@@?@@@?@?@?@?@??ADPNnAZ~B\"                     },                     \"start_location\" : {                        \"lat\" : 45.4076384,                        \"lng\" : 11.8987415                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.2 km\",                        \"value\" : 241                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 33                     },                     \"end_location\" : {                        \"lat\" : 45.4053897,                        \"lng\" : 11.8956666                     },                     \"html_instructions\" : \"At the roundabout, take the \\u003cb\\u003e3rd\\u003c/b\\u003e exit onto \\u003cb\\u003eVia Giuseppe Orus\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"erctGeqrgA?@A??@?@?@?@?@?@@@?@@??@@??@@?@?@?@??A@??A?A@??A?A?A?A?A?A?ANGPAZBZBPBZPTPb@^|C~B\"                     },                     \"start_location\" : {                        \"lat\" : 45.4072286,                        \"lng\" : 11.8966732                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.6 km\",                        \"value\" : 644                     },                     \"duration\" : {                        \"text\" : \"2 mins\",                        \"value\" : 100                     },                     \"end_location\" : {                        \"lat\" : 45.4042574,                        \"lng\" : 11.8876636                     },                     \"html_instructions\" : \"Turn \\u003cb\\u003eright\\u003c/b\\u003e onto \\u003cb\\u003eVia S. Massimo\\u003c/b\\u003e\",                     \"maneuver\" : \"turn-right\",                     \"polyline\" : {                        \"points\" : \"ufctG}jrgAD~J@~CTpCBd@DdAJhBvAzId@xBX|ATdC\"                     },                     \"start_location\" : {                        \"lat\" : 45.4053897,                        \"lng\" : 11.8956666                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.1 km\",                        \"value\" : 113                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 30                     },                     \"end_location\" : {                        \"lat\" : 45.40394269999999,                        \"lng\" : 11.8865108                     },                     \"html_instructions\" : \"At the roundabout, continue straight onto \\u003cb\\u003eVia Ospedale Civile\\u003c/b\\u003e\",                     \"maneuver\" : \"roundabout-right\",                     \"polyline\" : {                        \"points\" : \"s_ctG{xpgAA?A??@A?A@A@?@?@A??@?@A@?@?@?@?@?@?@@@?@?@@@?@?@@@@@@@@??@@?@?@?@?@?@?@A@AJZBNBLBPJn@L|@\"                     },                     \"start_location\" : {                        \"lat\" : 45.4042574,                        \"lng\" : 11.8876636                     },                     \"travel_mode\" : \"DRIVING\"                  },                  {                     \"distance\" : {                        \"text\" : \"0.3 km\",                        \"value\" : 310                     },                     \"duration\" : {                        \"text\" : \"1 min\",                        \"value\" : 66                     },                     \"end_location\" : {                        \"lat\" : 45.4063244,                        \"lng\" : 11.8844614                     },                     \"html_instructions\" : \"\\u003cb\\u003eVia Ospedale Civile\\u003c/b\\u003e turns \\u003cb\\u003eright\\u003c/b\\u003e and becomes \\u003cb\\u003eVia Aristide Gabelli\\u003c/b\\u003e\\u003cdiv style=\\\"font-size:0.9em\\\"\\u003eDestination will be on the right\\u003c/div\\u003e\",                     \"polyline\" : {                        \"points\" : \"s}btGuqpgAgAp@w@h@MJ]RWPOHe@ZIHA@ML{AxAc@b@u@t@MPCD\"                     },                     \"start_location\" : {                        \"lat\" : 45.40394269999999,                        \"lng\" : 11.8865108                     },                     \"travel_mode\" : \"DRIVING\"                  }               ],               \"traffic_speed_entry\" : [],               \"via_waypoint\" : []            }         ],         \"overview_polyline\" : {            \"points\" : \"yyixGkewoAi@{A}@fBxAxJP~D|Ebs@FxL[xL_AvCah@~r@qV`]eEjFkBzE~Cb@vGVpAw@fBkDdX`I~RpHh~@f]~MbEjIVzEg@~I_FjU_TrGkC|O_Bf}@cGxKsB|WyN`SuM|AEtCpBxAm@~ClGdJhXbOtTbNdRnDhI`C~ORnE|A`CvCyBxJtCtvAnqB`R`X`DdUnQr{@xRneABlAp@DnBoB~UkLrBoFj@aFdFkBpFM`HNtErK|GvPtD~Etd@|DrH`C~NbKfJrDxAl@ZaABeG~BiAnj@nq@vyAljBzpBlfC~dAvrArExElxF`fHzBtDnA`AhgAvtAB~Av@^x@Zv@tAfr@dz@hFnGbM|OjPjXdFrLfLj]~YliA|[hqAl@lAruD`wNtApEpGjVdOt^xPzTpEnDlT`C`QtCrFvBpR`NtCnHi@|JmD|Ms@bAtAvDzOdL~FtBfTNlIzCnDrClH~KzObYpEjAvFa@~QxN~EjD`A`@{@nEEvAdA~Rx@lI`@vLqAbGcAdAaAa@oAA{@dBqCfEaBf@u@EiBbD__@xc@gQlS}A@y@cAgBsFqAqRlA}G~JiNlFeC`MY`FhCvBpGdGj\\\\dGrh@hHzcAfEda@rMfw@hQrq@zMv_@rgAvdCzUxf@~k@pdAxSjd@tHhTd[vpA`p@hyCnVhhAhWnkAh`@bcBrOvd@dNtZvk@blAhUre@xSph@~Kn^pNbl@rZnjAdg@pvAbn@paBvnApfDv[x_ArZjbA~bAf{CtPpg@zNj]hg@ngAlf@~eA~Trj@rk@l`BnWtt@lZbw@|_@vz@hl@dqAdUre@jUf`@ngAjhBxRv[lVff@fKtXlEpXl@xLYf[sPhmAiUfzA{C`McVvl@oQpc@sJfe@cUnoBi@fU`@nW|D~_@dT|~@lDpV`Bxd@eB|f@mDzg@yF|cA|@fa@zEr_@`b@|~Axh@loBdS~j@`PnXxM~NlPpKjSzFfZ`BjSlC`|@lb@dPjGfN|BlP\\\\rZcAzX`FlPpCvIDz`@eCxUjBfOx@fY_@l`@jDhWa@xR?|YrFlb@vSdZvQxH|I`JhQjFbRvGlb@rIzj@hHbV|NjUdV~Q`{@dk@`OdMzH|JhJ`RvKvc@bEz[vJ|w@drBnnPn]vqCtGfi@dBpXcEdPNfD`C|BtHdEpBnS`AjIo@nCwFxG}@S_EoYwAl@jBxJrS``ApOhf@vMlf@pLpa@zBhKm@rCp@MjAO|@bCvAnJ^bFE\\\\fApF?NNONGnIlE`@vUnCdSf@fFCZPNZt@N`Ay@nB{BzAeGrFQV\"         },         \"summary\" : \"A4/E70\",         \"warnings\" : [],         \"waypoint_order\" : []      }   ],   \"status\" : \"OK\"}";
            } else {
                jsonResponse = makeHttpRequest(url);
            }
        } catch (IOException e) {
            Log.e(LOG_TAG, "Error during connection", e);
        }

        PolylineOptions polylineOptions = extractDataFromJson(jsonResponse);
        return polylineOptions;
    }

    private static String makeHttpRequest(URL url) throws IOException {
        String jsonResponse = null;
        if (url == null) {
            return jsonResponse;
        }

        HttpURLConnection httpURLConnection = null;
        InputStream inputStream = null;

        try {
            httpURLConnection = (HttpURLConnection) url.openConnection();
            httpURLConnection.setRequestMethod("GET");
            httpURLConnection.setConnectTimeout(15000);
            httpURLConnection.setReadTimeout(10000);
            httpURLConnection.connect();
            if (httpURLConnection.getResponseCode() == HttpURLConnection.HTTP_OK) {
                inputStream = httpURLConnection.getInputStream();
                jsonResponse = readFromStream(inputStream);
            } else {
                Log.e(LOG_TAG, "Error with connection code " + httpURLConnection.getResponseCode());
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            if (httpURLConnection != null) {
                httpURLConnection.disconnect();
            }
            if (inputStream != null) {
                inputStream.close();
            }
        }
        return jsonResponse;
    }

    private static String readFromStream(InputStream inputStream) {
        StringBuilder stringBuilder = new StringBuilder();
        if (inputStream != null) {
            InputStreamReader inputStreamReader = new InputStreamReader(inputStream);
            BufferedReader bufferedReader = new BufferedReader(inputStreamReader);
            try {
                String line = bufferedReader.readLine();
                while (line != null) {
                    stringBuilder.append(line);
                    line = bufferedReader.readLine();
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return stringBuilder.toString();
    }

    private static URL createUrl(String query) {
        URL url = null;
        try {
            url = new URL(URLDecoder.decode(query, "UTF-8"));
        } catch (MalformedURLException e) {
            Log.e(LOG_TAG, "Error creating URL", e);
        } catch (UnsupportedEncodingException e) {
            Log.e(LOG_TAG, "Error creating URL", e);
        }
        return url;
    }

    private static PolylineOptions extractDataFromJson(String jsonResponse) {
        if (jsonResponse == null || TextUtils.isEmpty(jsonResponse)) {
            return null;
        }

        JSONObject jObject;
        List<List<HashMap<String, String>>> routes = null;
        PolylineOptions finalPolylines = null;

        try {
            jObject = new JSONObject(jsonResponse);
            Log.d(TAG,jsonResponse.toString());
            DataParserUtils parser = new DataParserUtils();
            Log.d(TAG, parser.toString());

            // Starts parsing data
            routes = parser.parse(jObject);
            finalPolylines = getPolyLinesFromData(routes);

        } catch (Exception e) {
            Log.d("ParserTask",e.toString());
            e.printStackTrace();
        }

        return finalPolylines;
    }

    private static PolylineOptions getPolyLinesFromData(List<List<HashMap<String, String>>> result) {
        ArrayList<LatLng> points;
        PolylineOptions lineOptions = null;

        // Traversing through all the routes
        for (int i = 0; i < result.size(); i++) {
            points = new ArrayList<>();
            lineOptions = new PolylineOptions();

            // Fetching i-th route
            List<HashMap<String, String>> path = result.get(i);

            // Fetching all the points in i-th route
            for (int j = 0; j < path.size(); j++) {
                HashMap<String, String> point = path.get(j);

                double lat = Double.parseDouble(point.get("lat"));
                double lng = Double.parseDouble(point.get("lng"));
                LatLng position = new LatLng(lat, lng);

                points.add(position);
            }

            // Adding all the points in the route to LineOptions
            lineOptions.addAll(points);
            lineOptions.width(10);
            lineOptions.color(Color.RED);
        }

        // Drawing polyline in the Google Map for the i-th route
        return lineOptions;
    }

    @TargetApi(Build.VERSION_CODES.HONEYCOMB_MR1)
    protected static int getSizeOf(Bitmap data) {
        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB_MR1) {
            return data.getRowBytes() * data.getHeight();
        } else {
            return data.getByteCount();
        }
    }

    private static Bitmap createBitmap(String url) {
        Bitmap bitmap = null;
        try {
            bitmap = BitmapFactory.decodeStream((InputStream) new URL(url).getContent());
        } catch (IOException e) {
            Log.e(LOG_TAG, e.getMessage());
        }
        return bitmap;
    }
}
